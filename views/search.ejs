<!doctype html>
<head>
    <%-include partials/head.ejs %>
    <script type="text/javascript" src="/javascripts/markerclusterer.js"></script>
    <script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/markerclusterer.js"></script>
       <script src="/javascripts/map.js" type="text/javascript"></script>
   <script src="/javascripts/geocodeController.js" type="text/javascript"></script>
</head>
<body>
    <div id="maincontainer">
        <%-include partials/header.ejs %>
        <div id="body">
            <div id="container">
                <div class="row">
                    <% include partials/mapgeobuttons.ejs %>
                </div>
                <div class="row">
                    <div class="ninecol">
                        <div id="map">
                            <div id="mymap"></div>
                        </div>

                        <div>
                            <div id="maptaglist" class="hide-element"><b>Filter by tags</b></div>
                            <ul id="maptags">
                            </ul>
                        </div>

                        <div id="showalltagsbutton" class="hide-element">Show all tags</div>
                    </div>
                    <div class="threecol last">
                        <div id="show-route-list-header">Routes</div>
                        <ul class="maplist showlist"></ul>
                    </div>
                </div>
                
            </div>
            <div class="clearfooter"></div>
        </div>
        <div id="footer"></div>
    </div>
</body>
</html>
<script>
    var gmap = null;
    var mapmarkers = [];
    var mc;
    var infowindow = new google.maps.InfoWindow();
    var geocodeCtrl = new geocodeController;
    var map = new Map;
    var center = new google.maps.LatLng(51.50678771873268, -0.12717489055171427)

    $(document).ready(function() {
    
        map.createMap('mymap', center, map.returnShowMapOptions(center));
        map.addInitialSearchListener();
        geocodeCtrl.init('#geolocate', '#userlocation', '#userlocationsubmit');
    
        map.filterByTag('#maptags');
        map.removeFilterByTag('#showalltagsbutton');
    });
      
</script>